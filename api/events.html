<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Event Scripting | TwilioQuest Extensions</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.twilio.com/quest/next/favicon.png">
    <meta name="description" content="Get started building new adventures in TwilioQuest.">
    <meta name="theme-color" content="#F22F46">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/extension-docs/assets/css/0.styles.a221b2e8.css" as="style"><link rel="preload" href="/extension-docs/assets/js/app.e838b5e0.js" as="script"><link rel="preload" href="/extension-docs/assets/js/2.d05b9e9e.js" as="script"><link rel="preload" href="/extension-docs/assets/js/19.b5ddc7a3.js" as="script"><link rel="preload" href="/extension-docs/assets/js/23.d238941b.js" as="script"><link rel="preload" href="/extension-docs/assets/js/9.fcd60aaf.js" as="script"><link rel="prefetch" href="/extension-docs/assets/js/10.8120d817.js"><link rel="prefetch" href="/extension-docs/assets/js/11.d6cb7f28.js"><link rel="prefetch" href="/extension-docs/assets/js/12.1ced3e34.js"><link rel="prefetch" href="/extension-docs/assets/js/13.4860cf58.js"><link rel="prefetch" href="/extension-docs/assets/js/14.1c5365e4.js"><link rel="prefetch" href="/extension-docs/assets/js/15.606c520a.js"><link rel="prefetch" href="/extension-docs/assets/js/16.d83ac961.js"><link rel="prefetch" href="/extension-docs/assets/js/17.73ed6749.js"><link rel="prefetch" href="/extension-docs/assets/js/18.2e006603.js"><link rel="prefetch" href="/extension-docs/assets/js/20.5b841133.js"><link rel="prefetch" href="/extension-docs/assets/js/21.c08eba82.js"><link rel="prefetch" href="/extension-docs/assets/js/22.66659e6e.js"><link rel="prefetch" href="/extension-docs/assets/js/24.cefa8143.js"><link rel="prefetch" href="/extension-docs/assets/js/25.38bff8d4.js"><link rel="prefetch" href="/extension-docs/assets/js/26.15b2f0ba.js"><link rel="prefetch" href="/extension-docs/assets/js/27.3cd23be9.js"><link rel="prefetch" href="/extension-docs/assets/js/28.a1b622a3.js"><link rel="prefetch" href="/extension-docs/assets/js/29.0bbb18cb.js"><link rel="prefetch" href="/extension-docs/assets/js/3.44922b97.js"><link rel="prefetch" href="/extension-docs/assets/js/30.a517b7af.js"><link rel="prefetch" href="/extension-docs/assets/js/31.9fe0d73d.js"><link rel="prefetch" href="/extension-docs/assets/js/32.feebc8b6.js"><link rel="prefetch" href="/extension-docs/assets/js/33.25d40cce.js"><link rel="prefetch" href="/extension-docs/assets/js/34.00d69dca.js"><link rel="prefetch" href="/extension-docs/assets/js/35.f7404a5f.js"><link rel="prefetch" href="/extension-docs/assets/js/36.db80ee82.js"><link rel="prefetch" href="/extension-docs/assets/js/37.6e1f79ad.js"><link rel="prefetch" href="/extension-docs/assets/js/38.b5a5aeef.js"><link rel="prefetch" href="/extension-docs/assets/js/39.0f823dbc.js"><link rel="prefetch" href="/extension-docs/assets/js/4.165a5d41.js"><link rel="prefetch" href="/extension-docs/assets/js/40.e01adccc.js"><link rel="prefetch" href="/extension-docs/assets/js/5.6a3e534e.js"><link rel="prefetch" href="/extension-docs/assets/js/6.be750d01.js"><link rel="prefetch" href="/extension-docs/assets/js/7.5fca2255.js"><link rel="prefetch" href="/extension-docs/assets/js/8.db59b7df.js">
    <link rel="stylesheet" href="/extension-docs/assets/css/0.styles.a221b2e8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/extension-docs/" class="home-link router-link-active"><!----> <span class="site-name">TwilioQuest Extensions</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/extension-docs/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/extension-docs/api/" class="nav-link router-link-active">
  API Reference
</a></div><div class="nav-item"><a href="/extension-docs/examples/" class="nav-link">
  Examples
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/extension-docs/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/extension-docs/api/" class="nav-link router-link-active">
  API Reference
</a></div><div class="nav-item"><a href="/extension-docs/examples/" class="nav-link">
  Examples
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>API Reference</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/extension-docs/api/" aria-current="page" class="sidebar-link">API Overview</a></li><li><a href="/extension-docs/api/levels.html" class="sidebar-link">Level Configuration</a></li><li><a href="/extension-docs/api/objectives.html" class="sidebar-link">Objective Configuration</a></li><li><a href="/extension-docs/api/events.html" aria-current="page" class="active sidebar-link">Event Scripting</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/extension-docs/api/events.html#event-object" class="sidebar-link">Event Object</a></li><li class="sidebar-sub-header"><a href="/extension-docs/api/events.html#world-api" class="sidebar-link">World API</a></li><li class="sidebar-sub-header"><a href="/extension-docs/api/events.html#examples" class="sidebar-link">Examples</a></li></ul></li><li><a href="/extension-docs/api/objects.html" class="sidebar-link">Built-in Game Objects</a></li><li><a href="/extension-docs/api/custom_objects.html" class="sidebar-link">Custom Objects</a></li><li><a href="/extension-docs/api/conversations.html" class="sidebar-link">Conversation HTML</a></li></ul></section></li></ul> </aside> <main sidebar-items="[object Object]" class="page"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css"> <a target="_blank" href="http://github.com/TwilioQuest/extension-docs" data-ribbon="Contribute on GitHub" title="Contribute on GitHub" class="github-fork-ribbon left-bottom fixed">
    Contribute on GitHub
  </a> <div class="theme-default-content content__default"><h1 id="event-scripting"><a href="#event-scripting" class="header-anchor">#</a> Event Scripting</h1> <p>Levels expose a series of APIs and events that let you script custom behavior. Scripting lives in the <code>events.js</code> file located at <code>levels/&lt;level_name&gt;/events.js</code> for your level.</p> <p>The <code>events.js</code> file exports a single event handler function as it's default export. As events occur during the lifecycle of TwilioQuest, this function gets invoked with two properties. The first is an <code>event</code> object describing the event. The second is a <code>world</code> API object allowing you to modify the game world.</p> <h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <p><code>events.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> world</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="event-object"><a href="#event-object" class="header-anchor">#</a> Event Object</h2> <p>There are a variety of different events that you can respond to. The only required property on each event is <code>name</code>. You should use it to key off of and know which other properties to expect.</p> <h3 id="timerdidtrigger"><a href="#timerdidtrigger" class="header-anchor">#</a> timerDidTrigger</h3> <p>This event is triggered by a world API and can contain any arbitrary payload properties you attach to it. These properties are all attached to the root of the event.</p> <h4 id="properties"><a href="#properties" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;timerDidTrigger&quot;</code></li></ul> <h3 id="conversationdidend"><a href="#conversationdidend" class="header-anchor">#</a> conversationDidEnd</h3> <p>This event fires after a player closes a conversation with an NPC.</p> <h4 id="properties-2"><a href="#properties-2" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;conversationDidEnd&quot;</code></li> <li><code>npc (Object)</code>: This is the in game TwilioQuest entity for the Non Player Character that the player is conversing with.</li></ul> <h3 id="mapdidload"><a href="#mapdidload" class="header-anchor">#</a> mapDidLoad</h3> <p>This event fires after a map loads.</p> <h4 id="properties-3"><a href="#properties-3" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;mapDidLoad&quot;</code></li> <li><code>mapName (String)</code>: The key representing the map that loaded.</li></ul> <h3 id="levelwillunload"><a href="#levelwillunload" class="header-anchor">#</a> levelWillUnload</h3> <p>This event triggers right before the level finishes unloading. Synchronous behavior will occur before the level finishes unloading. Asynchronous behavior will not block level unloading. This should primarily be used for cleaning up any data or state.</p> <h4 id="properties-4"><a href="#properties-4" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;levelWillUnload&quot;</code></li></ul> <h3 id="leveldidload"><a href="#leveldidload" class="header-anchor">#</a> levelDidLoad</h3> <p>This event triggers right after a level loads. This triggers once even if the player transfers between different maps within a level.</p> <h4 id="properties-5"><a href="#properties-5" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;levelDidLoad&quot;</code></li></ul> <h3 id="playerdidinteract"><a href="#playerdidinteract" class="header-anchor">#</a> playerDidInteract</h3> <p>Triggers after a player interacts with anything in the game world.</p> <h4 id="properties-6"><a href="#properties-6" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;playerDidInteract&quot;</code></li> <li><code>target (Object)</code>: This is the in game TwilioQuest entity that the player interacted with.</li></ul> <h3 id="triggerareawasentered"><a href="#triggerareawasentered" class="header-anchor">#</a> triggerAreaWasEntered</h3> <p>Triggers after a player enters a region defined as a trigger area.</p> <h4 id="properties-7"><a href="#properties-7" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;triggerAreaWasEntered&quot;</code></li> <li><code>target (Object)</code>: A reference to the trigger area object that was entered. This is useful to determine which trigger area was entered.</li></ul> <h3 id="triggerareawasexited"><a href="#triggerareawasexited" class="header-anchor">#</a> triggerAreaWasExited</h3> <p>Triggers after a player exits a region defined as a trigger area.</p> <h4 id="properties-8"><a href="#properties-8" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;triggerAreaWasExited&quot;</code></li> <li><code>target (Object)</code>: A reference to the trigger area object that was exited. This is useful to determine which trigger area was exited.</li></ul> <h3 id="objectivedidopen"><a href="#objectivedidopen" class="header-anchor">#</a> objectiveDidOpen</h3> <p>Triggers after a player hacks an objective hack interface.</p> <h4 id="properties-9"><a href="#properties-9" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;objectiveDidOpen&quot;</code></li> <li><code>target (Object)</code>: A reference to the object that triggered the hack. The <code>objectiveName</code> property on this object is useful to determine which objective was hacked.</li></ul> <h3 id="objectivedidclose"><a href="#objectivedidclose" class="header-anchor">#</a> objectiveDidClose</h3> <p>Triggers after a player closes the objective hack interface.</p> <h4 id="properties-10"><a href="#properties-10" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;objectiveDidClose&quot;</code></li> <li><code>target (Object)</code>: A reference to the object that was last hacked. The <code>objectiveName</code> property on this object is useful to determine which objective was hacked.</li></ul> <h3 id="objectivefailed"><a href="#objectivefailed" class="header-anchor">#</a> objectiveFailed</h3> <p>Triggers after a player attempts to hack an objective and then the validator fails their attempt.</p> <h4 id="properties-11"><a href="#properties-11" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;objectiveFailed&quot;</code></li> <li><code>objective (String)</code>: The name of the objective that was failed.</li></ul> <h3 id="objectivecompleted"><a href="#objectivecompleted" class="header-anchor">#</a> objectiveCompleted</h3> <p>Triggers after a player attempts to hack an objective and then the validator passes their attempt. This event is only triggered the first time a player completes a given objective. Subsequent hacks fire <code>objectiveCompletedAgain</code>.</p> <h4 id="properties-12"><a href="#properties-12" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;objectiveCompleted&quot;</code></li> <li><code>objective (String)</code>: The name of the objective that was passed.</li></ul> <h3 id="objectivecompletedagain"><a href="#objectivecompletedagain" class="header-anchor">#</a> objectiveCompletedAgain</h3> <p>Triggers after a player attempts to hack an objective they've already completed and then the validator passes their attempt.</p> <h4 id="properties-13"><a href="#properties-13" class="header-anchor">#</a> Properties</h4> <ul><li><code>name (String)</code>: <code>&quot;objectiveCompletedAgain&quot;</code></li> <li><code>objective (String)</code>: The name of the objective that was passed.</li></ul> <h2 id="world-api"><a href="#world-api" class="header-anchor">#</a> World API</h2> <h3 id="getstate"><a href="#getstate" class="header-anchor">#</a> getState</h3> <ul><li>type: <code>function</code></li></ul> <p>Get a level state object for the corresponding key. This state is intended to be used by level authors to persist arbitrary information about their level.</p> <h4 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h4> <ul><li><code>key (String)</code>: A unique key to represent this level. Be aware that any invocation of setState from <em>any</em> level, not just yours.</li></ul> <h4 id="return"><a href="#return" class="header-anchor">#</a> Return</h4> <ul><li><code>Object</code>: any arbitary object of data a level author wishes to store</li></ul> <h3 id="setstate"><a href="#setstate" class="header-anchor">#</a> setState</h3> <ul><li>type: <code>function</code></li></ul> <p>Set a level state object for the corresponding key. This state is intended to be used by level authors to persist arbitrary information about their level.</p> <h4 id="parameters-2"><a href="#parameters-2" class="header-anchor">#</a> Parameters</h4> <ul><li><code>key (String)</code>: A unique key to represent this level. Be aware that any invocation of setState from <em>any</em> level, not just yours.</li> <li><code>value (Object)</code>: Arbitrary level data to persist.</li></ul> <h3 id="startconversation"><a href="#startconversation" class="header-anchor">#</a> startConversation</h3> <ul><li>type: <code>function</code></li></ul> <p>Start a specified conversation file with a given conversation portrait.</p> <h4 id="parameters-3"><a href="#parameters-3" class="header-anchor">#</a> Parameters</h4> <ul><li><code>conversation (String)</code>: A key representing a specific conversation file to be loaded.</li> <li><code>conversationAvatar (String)</code>: The conversation avatar file name - should be a file in the <code>images/conversations</code> folder of your extension. Some built-in avatar image names you can use (other than images in your own extension) are <code>cedricNeutral.png</code>, <code>cedricHappy.png</code>, <code>coreyNeutral.png</code>, etc.</li> <li><code>timeout (Number)</code>: Optional delay in milliseconds before the conversation starts playing. This value defaults to 0.</li></ul> <h3 id="showentities"><a href="#showentities" class="header-anchor">#</a> showEntities</h3> <ul><li>type: <code>function</code></li></ul> <p>Visually show all entities that match the provided key or filter function.</p> <h4 id="parameters-4"><a href="#parameters-4" class="header-anchor">#</a> Parameters</h4> <ul><li><code>keyOrFilter (String | Function)</code>: If this property is a string it will match all entities that have a <code>key</code> prop of the same value. If this is a function it will work as a filter function with the signature: <code>({ instance, collections, group, guid }) =&gt; Boolean</code>.</li> <li><code>timeout (Number)</code>: Optional delay in milliseconds before the conversation starts playing. This value defaults to 0.</li></ul> <h3 id="hideentities"><a href="#hideentities" class="header-anchor">#</a> hideEntities</h3> <ul><li>type: <code>function</code></li></ul> <p>Visually hide all entities that match the provided key or filter function.</p> <h4 id="parameters-5"><a href="#parameters-5" class="header-anchor">#</a> Parameters</h4> <ul><li><code>keyOrFilter (String | Function)</code>: If this property is a string it will match all entities that have a <code>key</code> prop of the same value. If this is a function it will work as a filter function with the signature: <code>({ instance, collections, group, guid }) =&gt; Boolean</code>.</li> <li><code>timeout (Number)</code>: Optional delay in milliseconds before the conversation starts playing. This value defaults to 0.</li></ul> <h3 id="destroyentities"><a href="#destroyentities" class="header-anchor">#</a> destroyEntities</h3> <ul><li>type: <code>function</code></li></ul> <p>Destroy (remove and clean up) all entities that match the provided key or filter function.</p> <h4 id="parameters-6"><a href="#parameters-6" class="header-anchor">#</a> Parameters</h4> <ul><li><code>keyOrFilter (String | Function)</code>: If this property is a string it will match all entities that have a <code>key</code> prop of the same value. If this is a function it will work as a filter function with the signature: <code>({ instance, collections, group, guid }) =&gt; Boolean</code>.</li> <li><code>timeout (Number)</code>: Optional delay in milliseconds before the conversation starts playing. This value defaults to 0.</li></ul> <h3 id="foreachentities"><a href="#foreachentities" class="header-anchor">#</a> forEachEntities</h3> <ul><li>type: <code>function</code></li></ul> <p>Iterate over all entities that match the provided key or filter function.</p> <h4 id="parameters-7"><a href="#parameters-7" class="header-anchor">#</a> Parameters</h4> <ul><li><code>keyOrFilter (String | Function)</code>: If this property is a string it will match all entities that have a <code>key</code> prop of the same value. If this is a function it will work as a filter function with the signature: <code>({ instance, collections, group, guid }) =&gt; Boolean</code>.</li> <li><code>forEach (Function)</code>: This function will be executed once for each entity that matches the <code>keyOrFilter</code>. This function has the signature: <code>(instance) =&gt; {}</code></li> <li><code>timeout (Number)</code>: Optional delay in milliseconds before the conversation starts playing. This value defaults to 0.</li></ul> <h3 id="shownotification"><a href="#shownotification" class="header-anchor">#</a> showNotification</h3> <ul><li>type: <code>function</code></li></ul> <p>Display a toast message on the lower half of the screen. This is the same style of message as interaction text effects.</p> <h4 id="parameters-8"><a href="#parameters-8" class="header-anchor">#</a> Parameters</h4> <ul><li><code>toastMessage (String)</code>: This is the text string that will be displayed in the message. HTML is valid here.</li> <li><code>timeout (Number)</code>: Optional delay in milliseconds before the conversation starts playing. This value defaults to 0.</li></ul> <h3 id="scheduletimerevent"><a href="#scheduletimerevent" class="header-anchor">#</a> scheduleTimerEvent</h3> <ul><li>type: <code>function</code></li></ul> <p>Set an event payload that will re-trigger your event handler at a specified time.</p> <h4 id="parameters-9"><a href="#parameters-9" class="header-anchor">#</a> Parameters</h4> <ul><li><code>payload (Object)</code>: This object will have it's properties spread over the event object that is passed into the event handler.</li> <li><code>timeout (Number)</code>: Delay in milliseconds before the conversation starts playing.</li></ul> <h3 id="removeobjective"><a href="#removeobjective" class="header-anchor">#</a> removeObjective</h3> <ul><li>type: <code>function</code></li></ul> <p>Clear a player's progress of the specified objective. This is useful if you need to perform data migrations between different versions of your level.</p> <h4 id="parameters-10"><a href="#parameters-10" class="header-anchor">#</a> Parameters</h4> <ul><li><code>missionName (String)</code>: The key of the mission this objective is owned by.</li> <li><code>objectiveName (String)</code>: The key of the objective being cleared.</li></ul> <h3 id="entityservice"><a href="#entityservice" class="header-anchor">#</a> entityService</h3> <ul><li>type: <code>EntityService</code></li></ul> <p>This is an underlying TwilioQuest service that exposes a lot of functionality about how we store and manage entities. The above entity manipulation methods should be preferred. This API may not be as stable.</p> <h3 id="getcontext"><a href="#getcontext" class="header-anchor">#</a> getContext</h3> <ul><li>type: <code>function</code></li></ul> <p>This allows access to the entirety of TwilioQuest's internal data storage. This contains a lot of powerful information. However, this is an internal API and the particular data contract you get is not guaranteed to stay stable.</p> <h4 id="parameters-11"><a href="#parameters-11" class="header-anchor">#</a> Parameters</h4> <ul><li><code>property (String)</code>: name of the context value being queried</li></ul> <h3 id="setcontext"><a href="#setcontext" class="header-anchor">#</a> setContext</h3> <ul><li>type: <code>function</code></li></ul> <p>This allows access to the entirety of TwilioQuest's internal data storage. This contains a lot of powerful information. However, this is an internal API and the particular data contract you get is not guaranteed to stay stable.</p> <h4 id="parameters-12"><a href="#parameters-12" class="header-anchor">#</a> Parameters</h4> <ul><li><code>property (String)</code>: name of the context value being set</li> <li><code>payload (Object)</code>: any arbitrary state data to persist</li></ul> <h3 id="emitter"><a href="#emitter" class="header-anchor">#</a> emitter</h3> <ul><li>type: <code>EventEmitter</code></li></ul> <p>This is an underlying TwilioQuest object that exposes a lot of functionality about how we store and manage data. This API may not be stable.</p> <h3 id="levelloader"><a href="#levelloader" class="header-anchor">#</a> levelLoader</h3> <ul><li>type: <code>LevelLoader</code></li></ul> <p>This is an underlying TwilioQuest object that exposes a lot of functionality about how we store and manage levels. This API may not be stable.</p> <h3 id="levelsdirectorypath"><a href="#levelsdirectorypath" class="header-anchor">#</a> levelsDirectoryPath <span class="badge warning" style="vertical-align:top;" data-v-15b7b770>deprecated</span></h3> <ul><li>type: <code>string</code></li></ul> <p>This is a string that provides a file path to the old bundled content in TwilioQuest. This has been replaced by the new extensions APIs and will be removed in future updates.</p> <h3 id="screenshake"><a href="#screenshake" class="header-anchor">#</a> screenShake</h3> <ul><li>type: <code>function</code></li></ul> <p>This function triggers a screen shake visual effect.</p> <h4 id="parameters-13"><a href="#parameters-13" class="header-anchor">#</a> Parameters</h4> <ul><li><code>amount (Number)</code>: Value for strength and duration of the screen shake effect. Low integers are generally recommended.</li> <li><code>timeout (Number)</code>: Delay in milliseconds before the conversation starts playing.</li></ul> <h3 id="enabletransitionareas"><a href="#enabletransitionareas" class="header-anchor">#</a> enableTransitionAreas</h3> <ul><li>type: <code>function</code></li></ul> <p>Enable (allow them to trigger events) all TransitionAreas that match the provided key or filter function.</p> <h4 id="parameters-14"><a href="#parameters-14" class="header-anchor">#</a> Parameters</h4> <ul><li><code>keyOrFilter (String | Function)</code>: If this property is a string it will match all entities that have a <code>key</code> prop of the same value. If this is a function it will work as a filter function with the signature: <code>({ instance, collections, group, guid }) =&gt; Boolean</code>.</li> <li><code>timeout (Number)</code>: Optional delay in milliseconds before the conversation starts playing. This value defaults to 0.</li></ul> <h3 id="disabletransitionareas"><a href="#disabletransitionareas" class="header-anchor">#</a> disableTransitionAreas</h3> <ul><li>type: <code>function</code></li></ul> <p>Disable (prevent them from triggering events) all TransitionAreas that match the provided key or filter function.</p> <h4 id="parameters-15"><a href="#parameters-15" class="header-anchor">#</a> Parameters</h4> <ul><li><code>keyOrFilter (String | Function)</code>: If this property is a string it will match all entities that have a <code>key</code> prop of the same value. If this is a function it will work as a filter function with the signature: <code>({ instance, collections, group, guid }) =&gt; Boolean</code>.</li> <li><code>timeout (Number)</code>: Optional delay in milliseconds before the conversation starts playing. This value defaults to 0.</li></ul> <h3 id="isobjectivecompleted"><a href="#isobjectivecompleted" class="header-anchor">#</a> isObjectiveCompleted</h3> <ul><li>type: <code>function</code></li></ul> <p>Check if a specified objective has been completed by the player.</p> <h4 id="parameters-16"><a href="#parameters-16" class="header-anchor">#</a> Parameters</h4> <ul><li><code>objective (String)</code>: The name of the objective being queried.</li> <li><code>mission (String)</code>: The name of the mission that owns this objective. This parameter is optional, if not provided it will default to the current mission.</li></ul> <h4 id="return-2"><a href="#return-2" class="header-anchor">#</a> Return</h4> <ul><li><code>Boolean</code>: returns true if the objective is completed</li></ul> <h3 id="getcurrentmapname"><a href="#getcurrentmapname" class="header-anchor">#</a> getCurrentMapName</h3> <ul><li>type: <code>function</code></li></ul> <p>Get the name of the currently loaded map.</p> <h4 id="return-3"><a href="#return-3" class="header-anchor">#</a> Return</h4> <ul><li><code>String</code>: the currently loaded map name</li></ul> <h3 id="getcurrentlevelname"><a href="#getcurrentlevelname" class="header-anchor">#</a> getCurrentLevelName</h3> <ul><li>type: <code>function</code></li></ul> <p>Get the name of the currently loaded level. This can be useful for reusable logic you want to share across levels.</p> <h4 id="return-4"><a href="#return-4" class="header-anchor">#</a> Return</h4> <ul><li><code>String</code>: the currently loaded level name</li></ul> <h3 id="showoverlaycomponent"><a href="#showoverlaycomponent" class="header-anchor">#</a> showOverlayComponent</h3> <ul><li>type: <code>function</code></li></ul> <p>Displays the specified component type over the rest of the game much like the Nav Map or the Hack Interface.</p> <p><a href="/examples/slideshow-extension">Example usage of the iframe component.</a></p> <h4 id="parameters-17"><a href="#parameters-17" class="header-anchor">#</a> Parameters</h4> <ul><li><code>overlayComponent (String|object)</code>: This is a key that represents which component will be opened. An object can be passed instead which allows more control of the component.</li> <li><code>timeout (Number)</code>: Optional delay in milliseconds before the conversation starts playing. This value defaults to 0.</li></ul> <h4 id="overlay-components"><a href="#overlay-components" class="header-anchor">#</a> Overlay Components</h4> <ul><li><code>navMap</code> - Shows the planet selection screen.
<ul><li><strong>props:</strong> <ul><li>none</li></ul></li></ul></li> <li><code>fogOwlFlying</code> - Shows the Fog Owl flying on a loading screen with stars in the background.
<ul><li><strong>props:</strong> <ul><li><code>fadeIn</code> - should this component fade in or start at full transparency. defaults to <code>false</code>.</li></ul></li></ul></li> <li><code>iframe</code> - Shows a component with an HTML iframe element. This can be used to display a URL inside of TwilioQuest.
<ul><li><strong>props:</strong> <ul><li><code>url</code> - string that is the URL the iframe will be opened to</li> <li><code>backgroundColor</code> - HTML color string for the background of the iframe</li> <li><code>fontColor</code> - HTML color string for the color of the iframe</li> <li><code>borderless</code> - Should this iframe element have a border</li></ul></li></ul></li></ul> <h3 id="disableplayermovement"><a href="#disableplayermovement" class="header-anchor">#</a> disablePlayerMovement</h3> <ul><li>type: <code>function</code></li></ul> <p>After this function is invoked, the player can no longer move. This will stay true until <a href="#enablePlayerMovement">enablePlayerMovement</a> is invoked.</p> <h3 id="enableplayermovement"><a href="#enableplayermovement" class="header-anchor">#</a> enablePlayerMovement</h3> <ul><li>type: <code>function</code></li></ul> <p>After this function is invoked, the player can move. This is mainly useful after <a href="#disablePlayerMovement">disablePlayerMovement</a> has been invoked.</p> <h3 id="usetool"><a href="#usetool" class="header-anchor">#</a> useTool</h3> <ul><li>type: <code>function</code></li></ul> <p>Plays the &quot;useTool&quot; animation in the direction that the player is currently facing. Also triggers a <code>playerUsedTool</code> event with a <code>toolId</code> property in it's payload equal to the provided toolId. This animation will play until <a href="#stopUsingTool">stopUsingTool</a> is invoked.</p> <h4 id="parameters-18"><a href="#parameters-18" class="header-anchor">#</a> Parameters</h4> <ul><li><code>toolId (String)</code>: A string that will used as part of the <code>playerUsedTool</code> payload.</li></ul> <h3 id="stopusingtool"><a href="#stopusingtool" class="header-anchor">#</a> stopUsingTool</h3> <ul><li>type: <code>function</code></li></ul> <p>Stops the current <code>useTool</code> animation running on the player. Also triggers the <code>playerStoppedUsingTool</code> event with the last used <code>toolId</code> attached to the payload.</p> <h3 id="usetool-2"><a href="#usetool-2" class="header-anchor">#</a> useTool</h3> <ul><li>type: <code>function</code></li></ul> <p>Plays the &quot;useTool&quot; animation in the direction that the player is currently facing. Also triggers a <code>playerUsedTool</code> event with a <code>toolId</code> property in it's payload equal to the provided toolId. This animation will play until <a href="#stopUsingTool">stopUsingTool</a> is invoked.</p> <h4 id="parameters-19"><a href="#parameters-19" class="header-anchor">#</a> Parameters</h4> <ul><li><code>toolId (String)</code>: A string that will used as part of the <code>playerUsedTool</code> payload.</li></ul> <h3 id="tweencameratoposition"><a href="#tweencameratoposition" class="header-anchor">#</a> tweenCameraToPosition</h3> <ul><li>type: <code>function</code></li></ul> <p><a href="https://phaser.io/docs/2.6.2/Phaser.Tween.html" target="_blank" rel="noopener noreferrer">Tweens<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (moves) the camera to the location specified by the given position.</p> <h4 id="parameters-20"><a href="#parameters-20" class="header-anchor">#</a> Parameters</h4> <ul><li><code>position (Object)</code>: An object with an <code>x</code> and <code>y</code> property.</li> <li><code>tweenConfig (Object)</code>: An object of <a href="https://phaser.io/docs/2.6.2/Phaser.Tween.html" target="_blank" rel="noopener noreferrer">Phaser tween<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> configurations that control how this Tween functions. Some sensible defaults are provided if this parameter is omitted.</li></ul> <h4 id="return-5"><a href="#return-5" class="header-anchor">#</a> Return</h4> <ul><li><code>Promise</code>: This promise resolves once the tween completes</li></ul> <h3 id="tweencameratoplayer"><a href="#tweencameratoplayer" class="header-anchor">#</a> tweenCameraToPlayer</h3> <ul><li>type: <code>function</code></li></ul> <p><a href="https://phaser.io/docs/2.6.2/Phaser.Tween.html" target="_blank" rel="noopener noreferrer">Tweens<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (moves) the camera to the current location of the Player.</p> <h4 id="parameters-21"><a href="#parameters-21" class="header-anchor">#</a> Parameters</h4> <ul><li><code>tweenConfig (Object)</code>: An object of <a href="https://phaser.io/docs/2.6.2/Phaser.Tween.html" target="_blank" rel="noopener noreferrer">Phaser tween<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> configurations that control how this Tween functions. Some sensible defaults are provided if this parameter is omitted.</li></ul> <h4 id="return-6"><a href="#return-6" class="header-anchor">#</a> Return</h4> <ul><li><code>Promise</code>: This promise resolves once the tween completes</li></ul> <h3 id="wait"><a href="#wait" class="header-anchor">#</a> wait</h3> <ul><li>type: <code>function</code></li></ul> <p>This is a convenience function that creates a promise which resolves after the specified amount of time.</p> <h4 id="parameters-22"><a href="#parameters-22" class="header-anchor">#</a> Parameters</h4> <ul><li><code>timeout (Number)</code>: length of time in milliseconds</li></ul> <h4 id="return-7"><a href="#return-7" class="header-anchor">#</a> Return</h4> <ul><li><code>Promise</code>: This promise resolves once the time has elapsed</li></ul> <h3 id="updatequeststatus"><a href="#updatequeststatus" class="header-anchor">#</a> updateQuestStatus</h3> <ul><li>type: <code>function</code></li></ul> <p>Update the current quest status of the provided level.</p> <h4 id="parameters-23"><a href="#parameters-23" class="header-anchor">#</a> Parameters</h4> <ul><li><code>levelName (String)</code>: key of the level's status</li> <li><code>title (String)</code>: title of the quest status message</li> <li><code>description (String)</code>: body of the quest status message</li> <li><code>complete (Boolean)</code>: should this quest be marked as completed</li> <li><code>ignoreLevelInfo (Boolean)</code>: should the default values in the level.json be used</li></ul> <h4 id="return-8"><a href="#return-8" class="header-anchor">#</a> Return</h4> <ul><li><code>Promise</code>: This promise resolves once the time has elapsed</li></ul> <h3 id="playbackgroundmusic"><a href="#playbackgroundmusic" class="header-anchor">#</a> playBackgroundMusic</h3> <ul><li>type: <code>function</code></li></ul> <p>Play the background music track of the provided name</p> <h4 id="parameters-24"><a href="#parameters-24" class="header-anchor">#</a> Parameters</h4> <ul><li><code>trackName (String)</code>: basename of the track to play</li></ul> <h3 id="warp"><a href="#warp" class="header-anchor">#</a> warp</h3> <ul><li>type: <code>function</code></li></ul> <p>Teleport the player to the specified location</p> <h4 id="parameters-25"><a href="#parameters-25" class="header-anchor">#</a> Parameters</h4> <ul><li><code>levelName (String)</code>: key of the level to teleport the player to</li> <li><code>playerEntryPoint (String)</code>: name of the player entry point the player should be warped to</li> <li><code>levelMapName (String)</code>: basename of the map that the player should be warped to</li></ul> <h3 id="grantitems"><a href="#grantitems" class="header-anchor">#</a> grantItems</h3> <ul><li>type: <code>function</code></li></ul> <p>Add a list of items to the player's inventory.</p> <h4 id="parameters-26"><a href="#parameters-26" class="header-anchor">#</a> Parameters</h4> <ul><li><code>grantedItems (Array)</code>: array of item keys (strings) to grant to the player</li></ul> <h3 id="removeitems"><a href="#removeitems" class="header-anchor">#</a> removeItems</h3> <ul><li>type: <code>function</code></li></ul> <p>Remove a list of items from the player's inventory.</p> <h4 id="parameters-27"><a href="#parameters-27" class="header-anchor">#</a> Parameters</h4> <ul><li><code>removedItems (Array)</code>: array of item keys (strings) to ensure are not in the player's inventory</li></ul> <h2 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">MISSION_COMPUTER_ARROW</span> <span class="token operator">=</span> <span class="token string">&quot;floating_arrow_mission_computer&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">CEDRIC_ARROW</span> <span class="token operator">=</span> <span class="token string">&quot;floating_arrow_cedric&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">FOG_OWL_STATE_KEY</span> <span class="token operator">=</span> <span class="token string">&quot;twilioquest.fog_owl&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">DEFAULT_STATE</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  hadFirstConversation<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  hasSeenMissionComputer<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> world</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Get our level's global state, use our default state if it's not found</span>
  <span class="token keyword">const</span> fogOwlState <span class="token operator">=</span> world<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token constant">FOG_OWL_STATE_KEY</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token constant">DEFAULT_STATE</span><span class="token punctuation">;</span>

  <span class="token comment">// First run onboarding sequence</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;levelDidLoad&quot;</span> <span class="token operator">&amp;&amp;</span> fogOwlState<span class="token punctuation">.</span>hadFirstConversation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    world<span class="token punctuation">.</span><span class="token function">startConversation</span><span class="token punctuation">(</span><span class="token string">&quot;cedric_initial&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;cedric&quot;</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Reveal the arrow above Cedric's head</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    event<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;conversationDidEnd&quot;</span> <span class="token operator">&amp;&amp;</span>
    event<span class="token punctuation">.</span>npc<span class="token punctuation">.</span>conversation <span class="token operator">===</span> <span class="token string">&quot;cedric_initial&quot;</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    world<span class="token punctuation">.</span><span class="token function">showEntities</span><span class="token punctuation">(</span><span class="token constant">CEDRIC_ARROW</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Track that we talked to cedric</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    event<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;conversationDidEnd&quot;</span> <span class="token operator">&amp;&amp;</span>
    event<span class="token punctuation">.</span>npc<span class="token punctuation">.</span>conversation <span class="token operator">===</span> <span class="token string">&quot;cedric&quot;</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fogOwlState<span class="token punctuation">.</span>hadFirstConversation <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    world<span class="token punctuation">.</span><span class="token function">hideEntities</span><span class="token punctuation">(</span><span class="token constant">CEDRIC_ARROW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Manage visibility of mission computer arrow</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    event<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;playerDidInteract&quot;</span> <span class="token operator">&amp;&amp;</span>
    event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;mission_computer&quot;</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fogOwlState<span class="token punctuation">.</span>hasSeenMissionComputer <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    world<span class="token punctuation">.</span><span class="token function">hideEntities</span><span class="token punctuation">(</span><span class="token constant">MISSION_COMPUTER_ARROW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>
    <span class="token operator">!</span>fogOwlState<span class="token punctuation">.</span>hasSeenMissionComputer <span class="token operator">&amp;&amp;</span>
    fogOwlState<span class="token punctuation">.</span>hadFirstConversation
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    world<span class="token punctuation">.</span><span class="token function">showEntities</span><span class="token punctuation">(</span><span class="token constant">MISSION_COMPUTER_ARROW</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Persist our level's state after this invocation of our event handler</span>
  world<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>fogOwlState<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div></main></div><div class="global-ui"></div></div>
    <script src="/extension-docs/assets/js/app.e838b5e0.js" defer></script><script src="/extension-docs/assets/js/2.d05b9e9e.js" defer></script><script src="/extension-docs/assets/js/19.b5ddc7a3.js" defer></script><script src="/extension-docs/assets/js/23.d238941b.js" defer></script><script src="/extension-docs/assets/js/9.fcd60aaf.js" defer></script>
  </body>
</html>
